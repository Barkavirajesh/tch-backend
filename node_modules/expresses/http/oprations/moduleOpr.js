// login
$scope.loginuser = function () {
  $http.post("/api/login/", $scope.login).then(function (response) {
    if (response.data.success) {
      $scope.user = response.data;
      $scope.isLoggedIn = true;
      $scope.message = "Login successful!";
    }
  });
};

// logout
$scope.logout = function () {
  $scope.isLoggedIn = false;
};

// get all users
$scope.allUser = function () {
  $http.get("/api/getAll/").then(function (response) {
    if (response.data.success) {
      $scope.users = response.data.user;
    } else {
      console.log("Users Not get");
    }
  });
};
$scope.allUser();

// new User
$scope.registerUser = function () {
  $http.post("/api/add/", $scope.newUser).then(function (response) {
    if (response.data.success) {
      $scope.message = "Registration successful!";
      alert("user registerd");
    } else {
      alert("Registration failed: " + response.data.message);
      $scope.message = "Registration failed: " + response.data.message;
    }
  });
  $scope.allUser();
};

// delete user
$scope.deleteuser = function (id) {
  $http.delete("/api/delete/" + id).then(
    function (response) {
      if (response.data.success) {
        $scope.message = "User deleted successfully!";
      } else {
        console.log("Deletion failed: " + response.data.message);
      }
    },
    function (error) {
      console.error("Server error during deletion:", error);
    }
  );
  $scope.allUser();
};

$scope.isEdit = function (adam) {
  $scope.isUpdate = true;
  $scope.newUser = adam;
};

// update User
$scope.updateUser = function () {
  $http
    .put("/api/update/" + $scope.newUser._id, $scope.newUser)
    .then(function (response) {
      if (response.data.success) {
        $scope.message = "User updated successfully!";
        $scope.newUser = {};
        $scope.isUpdate = false;
      } else {
        console.log("Update failed: " + response.data.message);
      }
    });
  $scope.allUser();
};
